<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>Valgrind - 檢查程式記憶體的小工具 &middot; </title>

  
  <link rel="stylesheet" href="https://swem.github.io/css/poole.css">
  <link rel="stylesheet" href="https://swem.github.io/css/hyde.css">
  <link rel="stylesheet" href="https://swem.github.io/css/poole-overrides.css">
  <link rel="stylesheet" href="https://swem.github.io/css/hyde-overrides.css">
  <link rel="stylesheet" href="https://swem.github.io/css/hyde-x.css">
  <link rel="stylesheet" href="https://swem.github.io/css/highlight/default.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://swem.github.io/touch-icon-144-precomposed.png">
  <link href="https://swem.github.io/favicon.png" rel="icon">

  
  
  
  

  <meta name="description" content="">
  <meta name="keywords" content="">
  
</head>
<body class="theme-base-08">
<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      
      <h1></h1>
      <p class="lead">Chen-Han (Stanley) Hsiao</p>
    </div>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item"><a href="https://swem.github.io/">Blog</a></li>
      
      <li class="sidebar-nav-item"><a href="https://swem.github.io/about/">About</a></li>
      
      <li class="sidebar-nav-item"><a href="https://swem.github.io/post/">Post</a></li>
      
    </ul>

    <ul class="sidebar-nav">
      <li class="sidebar-nav-item">
      <a href="https://github.com/swem"><i class="fa fa-github-square fa-3x"></i></a>
      
      
      <a href="https://www.linkedin.com/in/chen-han-hsiao-2b486049"><i class="fa fa-linkedin-square fa-3x"></i></a>
      
      
      
      
      
      </li>
    </ul>

    

    <p>Copyright &copy; 2017 <a href="https://swem.github.io/license/">License</a><br/>
       Powered by <a href="http://gohugo.io">Hugo</a> and <a href="https://github.com/zyro/hyde-x">Hyde-X</a></p>
  </div>
</div>


<div class="content container">
  <div class="post">
    <h1 class="post-title">Valgrind - 檢查程式記憶體的小工具</h1>
    <span class="post-date">Dec 17, 2012 &middot; 2 minute read
    
    <br/>
    
    </span>
    <p>Octopress 的第一篇文章，簡單介紹 Valgrind - 檢查程式記憶體的小工具</p>

<p>前陣子我對 project 進行 Debug
其中有一些 runtime error, 包含 memory leak</p>

<p>我使用 Valgrind 來檢查 Memory Leak</p>

<p>小範例，由 Valgrind 找出 test.cpp 第8行的 Bug  ( Invalid read )</p>

<p>{% codeblock lang:cpp %}
#include <iostream>
#include <vector>
using namespace std ;</p>

<p>int main()
{
    vector<double> array(1024);
    cout &lt;&lt; array[1024] &lt;&lt; endl ;
    return 0;
}
{% endcodeblock %}</p>

<p>$g++ -g test.cpp
$valgrind ./a.out</p>

<p>輸出訊息
{% codeblock %}
==9247== Memcheck, a memory error detector
==9247== Copyright &copy; 2002-2011, and GNU GPL&rsquo;d, by Julian Seward et al.
==9247== Using Valgrind-3.7.0 and LibVEX; rerun with -h for copyright info
==9247== Command: ./a.out
==9247==
==9247== Invalid read of size 8
==9247==    at 0x80487C4: main (test.cpp:8)
==9247==  Address 0x4336028 is 0 bytes after a block of size 8,192 alloc&rsquo;d
==9247==    at 0x402B9B4: operator new(unsigned int) (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==9247==    by 0x8048BD1: __gnu_cxx::new_allocator<double>::allocate(unsigned int, void const*) (new_allocator.h:92)
==9247==    by 0x8048B1D: std::_Vector_base<double, std::allocator<double> &gt;::_M_allocate(unsigned int) (in /home/stanleyhsiao/a.out)
==9247==    by 0x80489BC: std::_Vector_base<double, std::allocator<double> &gt;::_Vector_base(unsigned int, std::allocator<double> const&amp;) (stl_vector.h:123)
==9247==    by 0x80488D1: std::vector<double, std::allocator<double> &gt;::vector(unsigned int, double const&amp;, std::allocator<double> const&amp;) (stl_vector.h:265)
==9247==    by 0x80487A3: main (test.cpp:7)
==9247==
0
==9247==
==9247== HEAP SUMMARY:
==9247==     in use at exit: 0 bytes in 0 blocks
==9247==   total heap usage: 1 allocs, 1 frees, 8,192 bytes allocated
==9247==
==9247== All heap blocks were freed &ndash; no leaks are possible
==9247==
==9247== For counts of detected and suppressed errors, rerun with: -v
==9247== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)
{% endcodeblock %}</p>

  </div>
  
</div>




<script src="https://swem.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</body>
</html>

